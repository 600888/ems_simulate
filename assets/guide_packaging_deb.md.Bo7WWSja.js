import{_ as i,o as a,c as e,ag as n}from"./chunks/framework.DyNZgC5I.js";const k=JSON.parse('{"title":"Debian 打包与部署指南","description":"","frontmatter":{},"headers":[],"relativePath":"guide/packaging_deb.md","filePath":"guide/packaging_deb.md","lastUpdated":1769934959000}'),t={name:"guide/packaging_deb.md"};function l(p,s,d,h,r,o){return a(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="debian-打包与部署指南" tabindex="-1">Debian 打包与部署指南 <a class="header-anchor" href="#debian-打包与部署指南" aria-label="Permalink to &quot;Debian 打包与部署指南&quot;">​</a></h1><p>本文档介绍如何在 Debian/Ubuntu 环境下构建 <code>ems-simulate</code> 的 <code>.deb</code> 安装包，以及如何安装和管理服务。</p><h2 id="_1-环境准备" tabindex="-1">1. 环境准备 <a class="header-anchor" href="#_1-环境准备" aria-label="Permalink to &quot;1. 环境准备&quot;">​</a></h2><p>在开始构建之前，请确保您的构建机器（推荐 Ubuntu 20.04+ 或 Debian 10+）已安装以下必要工具：</p><ul><li><strong>基础工具</strong>: <code>git</code>, <code>dpkg-dev</code>, <code>binutils</code></li><li><strong>Python 环境</strong>: <code>python3</code>, <code>pip</code> (Python 3.11+)</li><li><strong>Node.js 环境</strong>: <code>npm</code> (用于构建前端)</li></ul><p>安装命令示例：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> binutils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3-pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_2-构建步骤" tabindex="-1">2. 构建步骤 <a class="header-anchor" href="#_2-构建步骤" aria-label="Permalink to &quot;2. 构建步骤&quot;">​</a></h2><p>项目的 <code>scripts</code> 目录下提供了自动化构建脚本，会自动处理前端编译、后端打包（PyInstaller）以及生成 <code>.deb</code> 包。</p><ol><li><p><strong>拉取代码</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/600888/ems_simulate.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems_simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><strong>运行构建脚本</strong>： 构建脚本会自动安装 Python 依赖（通过 <code>requirements.txt</code>）并开始构建。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scripts/build_deb.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./scripts/build_deb.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><strong>等待构建完成</strong>： 脚本执行完毕后，终端会显示构建成功的提示以及生成的包路径。</p><p><strong>输出产物</strong>：</p><ul><li>目录：<code>build/dist_deb/</code></li><li>文件：<code>ems-simulate_1.0.0_amd64.deb</code> (版本号可能随项目更新)</li></ul></li></ol><h2 id="_3-安装与卸载" tabindex="-1">3. 安装与卸载 <a class="header-anchor" href="#_3-安装与卸载" aria-label="Permalink to &quot;3. 安装与卸载&quot;">​</a></h2><h3 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h3><p>使用 <code>dpkg</code> 命令安装生成的 deb 包：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 请根据实际生成的文件名替换</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/dist_deb/ems-simulate_1.0.0_amd64.deb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>安装完成后，服务会自动注册并配置开机自启（视 <code>postinst</code> 脚本逻辑而定，通常需要手动启动一次）。</p><h3 id="卸载" tabindex="-1">卸载 <a class="header-anchor" href="#卸载" aria-label="Permalink to &quot;卸载&quot;">​</a></h3><h4 id="保留配置卸载-推荐" tabindex="-1">保留配置卸载 (推荐) <a class="header-anchor" href="#保留配置卸载-推荐" aria-label="Permalink to &quot;保留配置卸载 (推荐)&quot;">​</a></h4><p>仅删除程序文件，保留配置文件 (<code>config.ini</code>) 和运行时数据 (<code>data/</code> 目录)：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="完全清除-慎用" tabindex="-1">完全清除 (慎用) <a class="header-anchor" href="#完全清除-慎用" aria-label="Permalink to &quot;完全清除 (慎用)&quot;">​</a></h4><p>删除程序文件、配置文件以及产生的所有数据（包括数据库）：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="_4-服务管理" tabindex="-1">4. 服务管理 <a class="header-anchor" href="#_4-服务管理" aria-label="Permalink to &quot;4. 服务管理&quot;">​</a></h2><p>安装包会自动安装 Systemd 服务文件 <code>ems-simulate.service</code>。您可以使用 standard <code>systemctl</code> 命令进行管理。</p><ul><li><p><strong>启动服务</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>停止服务</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>重启服务</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>查看状态</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>查看日志</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看实时日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><strong>设置开机自启</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ems-simulate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul><h2 id="_5-目录结构说明" tabindex="-1">5. 目录结构说明 <a class="header-anchor" href="#_5-目录结构说明" aria-label="Permalink to &quot;5. 目录结构说明&quot;">​</a></h2><p>安装后的主要文件位置：</p><ul><li><strong>程序主目录</strong>: <code>/usr/share/ems-simulate/</code><ul><li><code>ems_simulate</code>: 主程序二进制文件</li><li><code>www/</code>: 前端静态资源</li><li><code>data/</code>: SQLite 数据库文件 (运行时生成)</li><li><code>config.ini</code>: 配置文件</li></ul></li><li><strong>服务文件</strong>: <code>/lib/systemd/system/ems-simulate.service</code></li><li><strong>可执行链接</strong>: <code>/usr/bin/ems-simulate</code></li></ul>`,28)])])}const u=i(t,[["render",l]]);export{k as __pageData,u as default};
